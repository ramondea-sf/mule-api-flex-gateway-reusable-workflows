# ============================================================================
# POLÍTICAS CORPORATIVAS - DEV / AWS-ROSA / PRIVATE
# ============================================================================
# Estas políticas são aplicadas automaticamente em TODAS as APIs privadas
# deployadas no cluster AWS-ROSA em ambiente DEV
#
# IMPORTANTE: Estas políticas são OBRIGATÓRIAS e aplicadas antes das
# políticas customizadas definidas em cada API

policies:
  inbound:
    # Rate Limiting básico para proteger o gateway
    - name: "rate-limiting"
      enabled: true
      version: "1.3.2"
      groupId: "68ef9520-24e9-4cf2-b2f5-620025690913"
      order: 1
      configuration:
        rateLimits:
          - timePeriodInMilliseconds: 60000
            maximumRequests: 1000
        exposeHeaders: true
        clusterizable: true

    # Message Logging corporativo
    - name: "message-logging-flex"
      enabled: true
      version: "1.2.0"
      groupId: "68ef9520-24e9-4cf2-b2f5-620025690913"
      order: 2
      configuration:
        loggingConfiguration:
          - itemName: "Corporate Logging"
            itemData:
              message: "#[{timestamp: now(), method: attributes.method, path: attributes.requestPath, clientIp: attributes.headers['x-forwarded-for'] default attributes.remoteAddress}]"
              level: "INFO"
              firstSection: true
              secondSection: true

  outbound:
    # CORS permissivo para DEV
    - name: "cors"
      enabled: true
      version: "1.2.0"
      groupId: "68ef9520-24e9-4cf2-b2f5-620025690913"
      order: 1
      configuration:
        publicResource: true
        supportCredentials: false
        allowedOrigins:
          - origin: "*"
        allowedMethods:
          - method: "GET"
          - method: "POST"
          - method: "PUT"
          - method: "DELETE"
          - method: "PATCH"
          - method: "OPTIONS"
        allowedHeaders:
          - header: "*"
        exposeHeaders: []
        maxAge: 3600


